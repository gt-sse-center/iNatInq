# =============================================================================
# Pipeline Service Environment Variables (Docker Compose Development)
# =============================================================================
# Source of truth for pipeline service configuration in Docker Compose.
# Mirrors the Kubernetes ConfigMap: modern-web-application/zarf/k8s/dev/pipeline/pipeline.env

# -----------------------------------------------------------------------------
# Ollama (Embedding Service)
# -----------------------------------------------------------------------------
# Default: Local Docker container
# External: Override OLLAMA_BASE_URL in .env.local or shell env
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_MODEL=nomic-embed-text
EMBEDDING_PROVIDER=ollama

# Timeout and circuit breaker settings
OLLAMA_TIMEOUT=60
OLLAMA_CIRCUIT_BREAKER_THRESHOLD=5
OLLAMA_CIRCUIT_BREAKER_TIMEOUT=30

# Batch settings
OLLAMA_BATCH_TIMEOUT_MULTIPLIER=1.0
OLLAMA_MAX_BATCH_SIZE=12

# -----------------------------------------------------------------------------
# Vector Database Provider
# -----------------------------------------------------------------------------
# Supported: qdrant, weaviate, pinecone, milvus
VECTOR_DB_PROVIDER=qdrant
VECTOR_DB_COLLECTION=documents

# -----------------------------------------------------------------------------
# Qdrant (Vector Store)
# -----------------------------------------------------------------------------
# Default: Local Docker container
# Cloud: Override QDRANT_URL and QDRANT_API_KEY in .env.local or shell env
QDRANT_URL=http://qdrant:6333
QDRANT_API_KEY=
QDRANT_COLLECTION=documents

# Timeout and circuit breaker settings
QDRANT_TIMEOUT=300
QDRANT_CIRCUIT_BREAKER_THRESHOLD=3
QDRANT_CIRCUIT_BREAKER_TIMEOUT=60

# -----------------------------------------------------------------------------
# Weaviate (Vector Store) - Alternative
# -----------------------------------------------------------------------------
# Default: Local Docker container
# Cloud: Override WEAVIATE_URL, WEAVIATE_API_KEY, WEAVIATE_GRPC_HOST in .env.local
WEAVIATE_URL=http://weaviate:8080
WEAVIATE_API_KEY=
WEAVIATE_GRPC_HOST=

# Timeout and circuit breaker settings
WEAVIATE_TIMEOUT=300
WEAVIATE_CIRCUIT_BREAKER_THRESHOLD=3
WEAVIATE_CIRCUIT_BREAKER_TIMEOUT=60

# -----------------------------------------------------------------------------
# S3/MinIO (Object Storage)
# -----------------------------------------------------------------------------
# Connection settings
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
S3_BUCKET=pipeline
S3_REGION=us-east-1
S3_USE_SSL=false
S3_PATH_STYLE=true

# Timeout and retry settings
S3_TIMEOUT=30
S3_MAX_RETRIES=3
S3_RETRY_MIN_WAIT=1.0
S3_RETRY_MAX_WAIT=10.0

# Circuit breaker settings
S3_CIRCUIT_BREAKER_THRESHOLD=5
S3_CIRCUIT_BREAKER_TIMEOUT=120

# -----------------------------------------------------------------------------
# Ray (Distributed Computing)
# -----------------------------------------------------------------------------
# Cluster configuration
RAY_ADDRESS=ray://ray-head:20001
RAY_DASHBOARD_ADDRESS=http://ray-head:8265
RAY_NAMESPACE=ml-pipeline
RAY_NUM_WORKERS=0

# Rate limiting and concurrency
RAY_OLLAMA_MAX_CONCURRENCY=2
RAY_OLLAMA_RPS=5

# Batch sizes
RAY_EMBED_BATCH_MIN=1
RAY_EMBED_BATCH_MAX=8
RAY_BATCH_UPSERT_SIZE=200
RAY_S3_BATCH_SIZE=50

# Checkpointing
RAY_CHECKPOINT_DIR=/data/ray-checkpoints
RAY_CHECKPOINT_ENABLED=true

# Task configuration (per-task settings)
RAY_TASK_NUM_CPUS=1
RAY_TASK_MAX_RETRIES=3
RAY_PIPELINE_CONCURRENCY=10

# Progress monitoring
RAY_WAIT_TIMEOUT=1.0
RAY_WAIT_BATCH_SIZE=10
RAY_PROGRESS_LOG_INTERVAL=1000

# Circuit breaker
RAY_CIRCUIT_BREAKER_THRESHOLD=5
RAY_CIRCUIT_BREAKER_TIMEOUT=30

# Timeouts (seconds)
RAY_EMBEDDING_TIMEOUT=120
RAY_UPSERT_TIMEOUT=60

# Retry configuration
RAY_RETRY_MAX_ATTEMPTS=3
RAY_RETRY_MIN_WAIT=1.0
RAY_RETRY_MAX_WAIT=10.0

# -----------------------------------------------------------------------------
# Environment Detection
# -----------------------------------------------------------------------------
PIPELINE_ENV=local
# K8S_NAMESPACE is intentionally not set (not running in Kubernetes)

